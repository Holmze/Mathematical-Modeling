# 灰色系统方法建模

## overview

客观世界的很多实际问题，其内部的结构、参数以及特征并未被人们全部了解，人们不可能象研究白箱问题那样将其内部机理研究清楚，只能依据某种思维逻辑与推断来构造模型。对这类部分信息已知而部分信息未知的系统，我们称之为灰色系统。本章介绍的方法是从灰色系统的本征灰色出发，研究在信息大量缺乏或紊乱的情况下，如何对实际问题进行分析和解决。

## 9.1灰色关联度与优势分析

客观事物往往现象复杂，因素繁多。我们经常要对系统进行因素分析，**这些因素中哪些对系统来讲是主要的，哪些是次要的，哪些需要发展，哪些需要抑制，哪些是潜在的，哪些是明显的**。事实上，因素间关联性如何、关联程度如何量化等问题是系统分析的关键。
例如人们关心的人口问题构成一个系统，影响人口发展变化的因素有**社会方面**的诸如计划生育、社会治安、社会生活方式等；有**经济方面**的诸如国民收入、社会福利、社会保险等；还有**医疗方面**的诸如医疗条件、医疗水平等……也就是说，**人口是多种因素互相关联、互相制约的系统，对这些因素进行分析将有助于人们对人口的未来预测及人口控制工作**。


### 灰色关联度

选取**参考数列**：
$X_0=\{X_0(K)|K=1,2,...,n\}=(X_0(1),X_0(2),...,X_0(n))$
其中k代表时刻。
假设有m个**比较数列**，
$X_i=\{X_i(K)|K=1,2,...,n\}=(X_i(1),X_i(2),...,X_i(n)),(i=1,2,...,m)$
则称：
$\zeta_i(k)=\frac{\min\limits_i\min\limits_k|X_0(k)-X_i(k)|+\rho\max\limits_i\max\limits_k|X_0(k)-X_i(k)|}{|X_0(k)-X_i(k)|+\max\limits_i\max\limits_k|X_0(k)-X_i(k)|} (1)$
为比较数列$X_i$对参考数列$X_0$在k时刻的**关联数量**，其中$\rho\in[0,+\infty)$为分辨系数。一般来说，分辨系数$\rho\in[0,1]$，由（1）可知，$\rho$越大，分辨率越大；$\rho$越小，分辨率越小。
式（1）定义的关联系数是描述比较数列与参考数列在某时刻关联程度的一种指标，由于各个时刻都有一个关联系数，因此信息显得过于分散，不便于比较，为此我们给出
$r_i=\frac{1}{n}\sum_{k=1}^{n}\zeta_i(k) （2）$
为比较数列$X_i$对参考数列$X_0$的关联度。
由式（2）容易看出，**关联度是把各个时刻的关联系数集中为一个平均值，即把过于分散的信息集中处理**。利用关联度这个概念，我们可以对各种问题进行因素分析。在利用（1）和（2）计算关联度之前，我们还需要对各个数列做初始化处理。一般来讲，实际问题中的不同数列往往具有不同的量纲，而我们在计算关联系数时，要求量纲要相同。因此**要首先对各种数据进行无量纲化**。另外，为了易于比较，要求所有数列有公共的交点。
为了解决上述两个问题，对给定数列进行变换，给定数列$X=(X(1),X(2),...,X(n))$，称$\frac{X(k)-\min X(k)}{\max X(k)-\min X(k)} \frac{\max X(k)-\min X(k)}{\max X(k)-\min X(k)} （3）$
为原始数列$X=(X(1),X(2),...,X(n))$的标准化数列。

## 9.2 灰色预测模型GM(1,1)及其应用

### 一、灰色预测模型GM(1,1)

#### 1.建模过程

(1)GM(1,1)代表一个白化形式的微分方程：
$\frac{dX^{(1)}}{dt}+aX^{(1)}=u （1）$
其中，a,u是需要通过建模求得的参数；$X^{(1)}$是原始数据$X^{(0)}$的累加生成值(AGO)。
(2)将同一数据列的前k项元素累加后产生新数据列的第k项元素，此为数据处理。可以表示为：
$X^{(1)}(k)=\sum_{n=1}^{k}X^{(0)}(n) （2）$
不直接采用原始数据$X^{(0)}$建模，而是将原始的、无规律的数据进行加工处理，使之变得较有规律，然后利用生成后的数据列来分析建模，这正是灰色系统理论的特点之一。
(3)对GM(1,1)，其数据矩阵为：
$$
B=
\begin{pmatrix}
    -0.5[X^{(1)}(1)+X^{(1)}(2))]&1\\
    -0.5[X^{(1)}(2)+X^{(1)}(3))]&1\\
    .&.\\
    .&.\\
    .&.\\
    -0.5[X^{(N-1)}(1)+X^{(1)}(N))]&1\\
\end{pmatrix} （2）
$$
向量$Y_N=[X^{(0)}(2),X^{(0)}(3),...,X^{(0)}(N)]^T$
(4)作修小二乘估计，求参数a,u
$$
\hat\alpha=
\begin{pmatrix}
    a\\
    u\\
\end{pmatrix}=(B^TB)^{-1}B^TY_N （4）
$$
(5)建立时间响应函数，求微分方程(1)的解为$\hat{X}^{(1)}(t+1)=(X^{(0)}(1)-\frac{u}{a})e^{-at}+\frac{u}{a} （5）$
这就是要建立的**灰色预测模型**。

#### 2.模型检验

(1)相对误差检验
令残差为$\varepsilon(k)=\frac{x^{(0)}(k)-\hat{x}^{(0)}(k)}{x^{(0)}(k)},k=1,2,...,n,$
这里的$\hat{x}^{(0)}(1)=x^{(0)}(1)$，如果$\varepsilon(k)<0.2$，则可认为达到一般要求；如果$\varepsilon(k)<0.1$，可认为达到较高要求。
(2)级别偏差值检验。
首先由参考数据$x^{(0)}(k-1),x^{(0)}(k)$计算出级比$\lambda(k)$，再用发展系数a求出相应的级别偏差
$\rho(k)=1-(\frac{1-0.5a}{1+0.5a})\lambda(k)$
如果$\rho(k)<0.2$，则可认为达到一般要求；如果$\rho(k)<0.1$，可认为达到较高要求。