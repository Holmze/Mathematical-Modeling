# CH5差分方程方法建模

## overview

在日常生活和科学技术中我们经常遇到一些和时间有关的量，例如某地的气温，证券市场指数，一个地区人口数，……。研究这些量随时间变化的规律，在理论和实践上都有重要的意义。随时间而变化的量称为动态变量，以动态变量为状态变量的系统称为动态系统。在许多实际问题中，动态变量是随时间（如天、年）离散变化的。
本章通过一些简单的例子，介绍一种研究离散型动态系统的方法——差分方程。

## 5.1抵押贷款与养老保险

### 模型一：抵押贷款

现在人们从购房到购买大件物品（如汽车、家电）均可采用抵押贷款和分期付款等方式。某人向银行贷一笔款用于购房，计划若干年内还清，应如何计算出每月偿还数额。
单位时间为月，抵押贷款期限为N个月，贷款额为$A_0$，月利率为R，按照复利计算，每月还钱x，还款约定从借款日的下一个月开始，于是：
第一个月后还欠款：$A_1=(1+R)A_0-x$
第二个月后还欠款：$A_2=(1+R)A_1-x$
......
第N个月后还欠款：$A_N=(1+R)A_{N-1}-x$
这是一种特殊的差分方程，逐项代入后可得：
$A_N=A_0(1+R)^N-x[(1+R)^{N-1}+...+1]=A_0(1+R)^N-x\frac{(1+R)^N-1}{R}$ **（1）**
N月还清，即$A_N=0$，由**（1）**可得：
$x=\frac{A_0R(1+R)^N}{(1+R)^N-1}$ **（2）**
例如：购买二居室一套的公房，共十万元一次付清，向银行申请6万元抵押贷款，月利率1%，期限25年，计算每月应还多少钱？(答案是631.93元)。

### 模型二：养老保险

某保险公司的一份材料指出，在每月交费200元至59岁年底，60岁开始领取养老金的约定下，男子若25岁起投保，届时月养老金2282元；假定人的寿命为75岁，试求出保险公司为了兑现保险责任，每月至少应有多少投资收益率？
设r表示保险金的投资收益率，缴费期间月缴费额为p元，领养老金期间月领取额为q元，缴费的月数为N，到75岁时领取的养老金的月数为M，投保人在投保后第k个月所交保险费即收益的累计总额为$F_k$，则可得分段表示的差分方程：
$F_{k+1}=F_k(1+r)+p,k=0,1,...,N-1$
$F_{k+1}=F_k(1+r)-q,k=N,N+1,...,M-1$
由于$F_0=F_M=0$，可得差分方程的解：
$F_k=[(1+r)^k-1]\frac{p}{r},k=0,1,2,...,N$ **（1）**
$F_k=\frac{q}{r}[1-(1+r)^{k-M}],k=N+1,...,M$ **（2）**
由（1）和（2）可得：
$F_N=[(1+r)^N-1]\frac{p}{r}$
$F_{N+1}=\frac{q}{r}[1-(1+r)^{N+1-M}]$
由于$F_{N+1}=F_N(1+r)-q$，可得下面的方程：
$\frac{q}{r}[1-(1+r)^{N+1-M}]=[(1+r)^N-1]\frac{p}{r}(1+r)-q$
化简得：$(1+r)^M-(1+\frac{q}{p})(1+r)^{M-N}+\frac{q}{p}=0$

## 5.2商品销售量预测

利用往年的商品销量预测下一年各个季度的商品销量
在利用常系数线性差分方程：
$y_t=a_1y_{t-1}+a_2$
或$y_t=a_1y_{t-1}+a_2y_{t-2}+a_3$
建模研究实际问题，常常需要根据统计数据用最小二乘法来拟合差分方程的系数

**差分方程中的系数不一定能使所有统计数据吻合**，较为合理的办法使用最小二乘法求一组总体上较为吻合的数据。
以二阶差分方程$y_t=a_1y_{t-1}+a_2y_{t-2}+a_3$为例，假设有五组数据。对于已知观测数据$y_t(t=1,2,...,5)$，选取合适的$a_1,a_2,a_3$使得
$Q=\sum\limits_{t=3}^{5}[y_t-(a_1y_{t-1}+a_2y_{t-2}+a_3)]^2$达到最小值。
$$
\begin{cases}
    \frac{\partial Q}{\partial a_1}=2\sum\limits_{t=3}^{5}[(a_1y_{t-1}+a_2y_{t-2}+a_3)-y_t]y_{t-1}=0\\
    \frac{\partial Q}{\partial a_2}=2\sum\limits_{t=3}^{5}[(a_1y_{t-1}+a_2y_{t-2}+a_3)-y_t]y_{t-2}=0\\
    \frac{\partial Q}{\partial a_3}=2\sum\limits_{t=3}^{5}[(a_1y_{t-1}+a_2y_{t-2}+a_3)-y_t]=0
\end{cases}
$$
$$
\begin{cases}
    (\sum\limits_{t=3}^{5}y_{t-1}^2)a_1+(\sum\limits_{t=3}^{5}y_{t-1}y_{t-2})a_2+(\sum\limits_{t=3}^{5}y_{t-1})a_3=\sum\limits_{t=3}^{5}y_ty_{t-1}\\
    (\sum\limits_{t=3}^{5}y_{t-1}y_{t-2})a_1+(\sum\limits_{t=3}^{5}y_{t-2}^2)a_2+(\sum\limits_{t=3}^{5}y_{t-2})a_3=\sum\limits_{t=3}^{5}y_ty_{t-2}\\
    (\sum\limits_{t=3}^{5}y_{t-1})a_1+(\sum\limits_{t=3}^{5}y_{t-2})a_2+(\sum\limits_{t=3}^{5}1)a_3=\sum\limits_{t=3}^{5}y_t
\end{cases}
$$
得到下面的线性方程组
$$
\begin{pmatrix}
    y_2&y_3&y_4\\
    y_1&y_2&y_3\\
    1&1&1
\end{pmatrix}
\begin{pmatrix}
    y_2&y_1&1\\
    y_3&y_2&1\\
    y_4&y_3&1
\end{pmatrix}
\begin{pmatrix}
    a_1\\
    a_2\\
    a_3
\end{pmatrix}
=\begin{pmatrix}
    y_2&y_3&y_4\\
    y_1&y_2&y_3\\
    1&1&1
\end{pmatrix}
\begin{pmatrix}
    y_3\\
    y_4\\
    y_5
\end{pmatrix}
$$
上述为预测各年第一季度销售量而建立的二阶差分方程，虽然其系数与前5年第一季度的统计数据完全吻合，但用于预测时预测值与事实不符。稍作分析，不难看出，**如分别对每一季度建立一个差分方程，则根据统计数据拟合出的系数可能会相差甚大**，但==对同一种商品，这种差异应当是微小的==，故应根据统计数据建立一个共用于各个季度的差分方程。