# 第十章：插值与你和方法建模

在生产实际中，常常要处理由实验或测量所得到的一批离散数据，插值与拟合方法就是要通过这些数据去确定某一类已知函数的参数，或==寻求某个近似函数使之与已知数据有较高的拟合精度==。插值与拟合的方法很多，这里主要介绍**线性插值方法**、**多项式插值方法**和**样条插值方法**，以及**最小二乘拟合方法**在实际问题中的应用。

## 10.1数据插值方法及应用

在生产实践和科学研究中，由实验或测量得到变量间的一批离散样点，要求*由此建立变量之间的函数关系或得到样点之外的数据*。与此有关的一类问题是当原始数据$(x_0,y_0),(x_1,y_1),...,(x_n,y_n)$精度较高，要求确定一个初等函数$y=P(x)$（一般用多项式或分段多项式函数）通过已知各数据点（节点），即$y_i=P(x_i),i=0,1,...,n$，或要求得函数在另外一些点（插值点）处的数值，这便是插值问题。

### 一、一维插值

#### 1.分段线性插值

将各数据用折线连接，如果
$a=x_0<x_1<...<x_n=b$
那么分段线性插值公式为：
$P(x)=\frac{x-x_i}{x_{i-1}-x_i}y_{i-1}+\frac{x-x_{i-1}}{x_i-x_{i-1}}y_i,x_{i-1}<x\le x_i,i=1,2,...,n$
==当分点足够细时，分段线性插值是收敛的，其缺点是不能形成一条光滑曲线。==

#### 2.多项式插值

假设有m次多项式$P(x)=a_0x^m+a_1x^{m-1}+...+a_{m-1}x+a_m$
通过所有n+1个点$(x_0,y_0),(x_1,y_1),...,(x_n,y_n)$，那么就有：
$a_0x_i^m+a_1x_i^{m-1}+...+a_{m-1}x_i+a_m=y_i,i=0,1,...,n$
可以证明当$m=n$且$x_0<x_1<...<x_n$时，这样的多项式存在且唯一。若要求函数表达式，可以直接解上述方程组。若只要求函数在插值点处的数值，可用lagrange插值公式：
$P_n(x)=\sum\limits_{i=0}^{n}y_i(\prod\limits_{j=0,j\not ={i}}^{n}\frac{x-x_j}{x_i-x_j})$
==多项式插值光滑但不具有收敛性，一般不宜采用高次多项式（m>7）插值。==

#### 3.样条插值

最常用的插值方法。所谓样条，实际上时指**分段多项式的光滑连接**，设：
$a=x_0<x_1<...<x_n=b$
称分段函数$S(x)$为==k次样条函数==，若其满足：
1.$S(x)在每个小区间上是次数不超过k的多项式$
2.$S(x)在[a,b]上具有直到k-1阶的连续导数$
用样条插值做出的插值称为样条插值，工业界广泛采用三次样条插值。

### 二、二维插值

$Z1=interp2(X,Y,Z,X1,Y1,'method')$
其中X和Y为两个向量，分别描述原始数据点的自变量取值，Z是对应于X和Y的函数值；X1和Y1是两个向量，描述欲插值的点。method的含义同一维插值。Z1是根据相应的插值方法得到的插值结果。